<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Redux核心点理解 | 狼子笔记</title>
    <meta name="generator" content="VuePress 1.5.0">
    <link rel="icon" href="/favicon.ico">
    <link rel="manifest" href="/manifest.json">
    <meta name="description" content="王龙楷个人博客,王龙楷,狼子笔记,个人博客,前端笔记,面试技巧,Vue,javascript,DBCss,html5">
    <meta name="keywords" content="王龙楷个人博客,王龙楷,狼子笔记,个人博客,前端笔记,前端,vue,博客,javascript,html,DBCss">
    <link rel="preload" href="/assets/css/0.styles.d1d9bb2b.css" as="style"><link rel="preload" href="/assets/js/app.36f13d28.js" as="script"><link rel="preload" href="/assets/js/2.0b44b90b.js" as="script"><link rel="preload" href="/assets/js/80.1f4220a2.js" as="script"><link rel="preload" href="/assets/js/9.58f2bd3e.js" as="script"><link rel="prefetch" href="/assets/js/10.87ea37a2.js"><link rel="prefetch" href="/assets/js/11.207ce0d5.js"><link rel="prefetch" href="/assets/js/12.e3e99f59.js"><link rel="prefetch" href="/assets/js/13.dc170ad6.js"><link rel="prefetch" href="/assets/js/14.37f76075.js"><link rel="prefetch" href="/assets/js/15.7a610ad9.js"><link rel="prefetch" href="/assets/js/16.1228dd9d.js"><link rel="prefetch" href="/assets/js/17.f4f4ff5d.js"><link rel="prefetch" href="/assets/js/18.f59a9d95.js"><link rel="prefetch" href="/assets/js/19.00fda91a.js"><link rel="prefetch" href="/assets/js/20.9e0c37db.js"><link rel="prefetch" href="/assets/js/21.3b8d3668.js"><link rel="prefetch" href="/assets/js/22.302d2564.js"><link rel="prefetch" href="/assets/js/23.2fd1cc8b.js"><link rel="prefetch" href="/assets/js/24.8d25b048.js"><link rel="prefetch" href="/assets/js/25.9a975607.js"><link rel="prefetch" href="/assets/js/26.c0b5df06.js"><link rel="prefetch" href="/assets/js/27.0187076a.js"><link rel="prefetch" href="/assets/js/28.7717ebc0.js"><link rel="prefetch" href="/assets/js/29.1d860d6c.js"><link rel="prefetch" href="/assets/js/3.7e0cdc3a.js"><link rel="prefetch" href="/assets/js/30.a52a4438.js"><link rel="prefetch" href="/assets/js/31.584ae3bf.js"><link rel="prefetch" href="/assets/js/32.1d389fca.js"><link rel="prefetch" href="/assets/js/33.d59cf09d.js"><link rel="prefetch" href="/assets/js/34.4ee0a639.js"><link rel="prefetch" href="/assets/js/35.ad87d683.js"><link rel="prefetch" href="/assets/js/36.c4559235.js"><link rel="prefetch" href="/assets/js/37.dd87dc0b.js"><link rel="prefetch" href="/assets/js/38.89d47057.js"><link rel="prefetch" href="/assets/js/39.817a05f8.js"><link rel="prefetch" href="/assets/js/4.0a97cf23.js"><link rel="prefetch" href="/assets/js/40.fdd8aa01.js"><link rel="prefetch" href="/assets/js/41.e8281c5c.js"><link rel="prefetch" href="/assets/js/42.dad37556.js"><link rel="prefetch" href="/assets/js/43.af1146bb.js"><link rel="prefetch" href="/assets/js/44.f2751dcd.js"><link rel="prefetch" href="/assets/js/45.48907eaa.js"><link rel="prefetch" href="/assets/js/46.867d08f6.js"><link rel="prefetch" href="/assets/js/47.f7908450.js"><link rel="prefetch" href="/assets/js/48.533a4f1c.js"><link rel="prefetch" href="/assets/js/49.dab3e848.js"><link rel="prefetch" href="/assets/js/5.4cdcc44a.js"><link rel="prefetch" href="/assets/js/50.613c7429.js"><link rel="prefetch" href="/assets/js/51.ccb17673.js"><link rel="prefetch" href="/assets/js/52.ab09b1aa.js"><link rel="prefetch" href="/assets/js/53.38939f33.js"><link rel="prefetch" href="/assets/js/54.2e331abb.js"><link rel="prefetch" href="/assets/js/55.e3cc5f42.js"><link rel="prefetch" href="/assets/js/56.8566fc5d.js"><link rel="prefetch" href="/assets/js/57.ad689221.js"><link rel="prefetch" href="/assets/js/58.fd812560.js"><link rel="prefetch" href="/assets/js/59.1f315f2e.js"><link rel="prefetch" href="/assets/js/6.93c464b1.js"><link rel="prefetch" href="/assets/js/60.dd234ebe.js"><link rel="prefetch" href="/assets/js/61.68319499.js"><link rel="prefetch" href="/assets/js/62.fa22e5fd.js"><link rel="prefetch" href="/assets/js/63.704c5a80.js"><link rel="prefetch" href="/assets/js/64.a700a0e3.js"><link rel="prefetch" href="/assets/js/65.69833db0.js"><link rel="prefetch" href="/assets/js/66.28e6045e.js"><link rel="prefetch" href="/assets/js/67.9f497606.js"><link rel="prefetch" href="/assets/js/68.54302ea2.js"><link rel="prefetch" href="/assets/js/69.ac423cfa.js"><link rel="prefetch" href="/assets/js/7.bb6c1904.js"><link rel="prefetch" href="/assets/js/70.d7f5bec4.js"><link rel="prefetch" href="/assets/js/71.28682fc4.js"><link rel="prefetch" href="/assets/js/72.21c84165.js"><link rel="prefetch" href="/assets/js/73.76ee998a.js"><link rel="prefetch" href="/assets/js/74.83b64680.js"><link rel="prefetch" href="/assets/js/75.0b812439.js"><link rel="prefetch" href="/assets/js/76.b7aa5cf7.js"><link rel="prefetch" href="/assets/js/77.eac28ced.js"><link rel="prefetch" href="/assets/js/78.4cf4f8ed.js"><link rel="prefetch" href="/assets/js/79.5df9fdfb.js"><link rel="prefetch" href="/assets/js/8.e840d0f8.js"><link rel="prefetch" href="/assets/js/81.d11548b3.js"><link rel="prefetch" href="/assets/js/82.18b7d4a2.js"><link rel="prefetch" href="/assets/js/83.8352c606.js"><link rel="prefetch" href="/assets/js/84.10e94f68.js"><link rel="prefetch" href="/assets/js/85.a1f0cca6.js"><link rel="prefetch" href="/assets/js/86.44226763.js">
    <link rel="stylesheet" href="/assets/css/0.styles.d1d9bb2b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">狼子笔记</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Vue" class="dropdown-title"><span class="title">Vue</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/vue/vue_basic/" class="nav-link">
  vue核心库
</a></li><li class="dropdown-item"><!----> <a href="/blog/vue/vuex.html" class="nav-link">
  vuex
</a></li><li class="dropdown-item"><!----> <a href="/blog/vue/vue_router.html" class="nav-link">
  vue-router
</a></li><li class="dropdown-item"><!----> <a href="/blog/vue/vue_mockjs.html" class="nav-link">
  vue-mockjs
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="React" class="dropdown-title"><span class="title">React</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/react/setState.html" class="nav-link">
  this.setState
</a></li><li class="dropdown-item"><!----> <a href="/blog/react/Lazy&amp;Suspense.html" class="nav-link">
  React.lazy&amp;React.Suspense
</a></li><li class="dropdown-item"><!----> <a href="/blog/react/Context.html" class="nav-link">
  Context
</a></li><li class="dropdown-item"><!----> <a href="/blog/react/redux_core.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  redux概念理解
</a></li><li class="dropdown-item"><!----> <a href="/blog/react/react-redux.html" class="nav-link">
  react-redux基本使用
</a></li><li class="dropdown-item"><!----> <a href="/blog/react/mobx-basic.html" class="nav-link">
  mobx基本使用
</a></li><li class="dropdown-item"><!----> <a href="/blog/react/reactAnswer.html" class="nav-link">
  react小知识点
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="JavaScript" class="dropdown-title"><span class="title">JavaScript</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/ECMAScript/ES3_5/" class="nav-link">
  JS3_5
</a></li><li class="dropdown-item"><!----> <a href="/blog/ECMAScript/ES_Next/" class="nav-link">
  ES_Next
</a></li></ul></div></div><div class="nav-item"><a href="/blog/DBCss/" class="nav-link">
  DOM+CSS
</a></div><div class="nav-item"><a href="/blog/other/" class="nav-link">
  Others
</a></div><div class="nav-item"><a href="/blog/daily/" class="nav-link">
  随笔
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Vue" class="dropdown-title"><span class="title">Vue</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/vue/vue_basic/" class="nav-link">
  vue核心库
</a></li><li class="dropdown-item"><!----> <a href="/blog/vue/vuex.html" class="nav-link">
  vuex
</a></li><li class="dropdown-item"><!----> <a href="/blog/vue/vue_router.html" class="nav-link">
  vue-router
</a></li><li class="dropdown-item"><!----> <a href="/blog/vue/vue_mockjs.html" class="nav-link">
  vue-mockjs
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="React" class="dropdown-title"><span class="title">React</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/react/setState.html" class="nav-link">
  this.setState
</a></li><li class="dropdown-item"><!----> <a href="/blog/react/Lazy&amp;Suspense.html" class="nav-link">
  React.lazy&amp;React.Suspense
</a></li><li class="dropdown-item"><!----> <a href="/blog/react/Context.html" class="nav-link">
  Context
</a></li><li class="dropdown-item"><!----> <a href="/blog/react/redux_core.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  redux概念理解
</a></li><li class="dropdown-item"><!----> <a href="/blog/react/react-redux.html" class="nav-link">
  react-redux基本使用
</a></li><li class="dropdown-item"><!----> <a href="/blog/react/mobx-basic.html" class="nav-link">
  mobx基本使用
</a></li><li class="dropdown-item"><!----> <a href="/blog/react/reactAnswer.html" class="nav-link">
  react小知识点
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="JavaScript" class="dropdown-title"><span class="title">JavaScript</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/ECMAScript/ES3_5/" class="nav-link">
  JS3_5
</a></li><li class="dropdown-item"><!----> <a href="/blog/ECMAScript/ES_Next/" class="nav-link">
  ES_Next
</a></li></ul></div></div><div class="nav-item"><a href="/blog/DBCss/" class="nav-link">
  DOM+CSS
</a></div><div class="nav-item"><a href="/blog/other/" class="nav-link">
  Others
</a></div><div class="nav-item"><a href="/blog/daily/" class="nav-link">
  随笔
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Redux核心点理解</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/react/redux_core.html#概念理解" class="sidebar-link">概念理解</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/react/redux_core.html#state" class="sidebar-link">state</a></li><li class="sidebar-sub-header"><a href="/blog/react/redux_core.html#action" class="sidebar-link">action</a></li><li class="sidebar-sub-header"><a href="/blog/react/redux_core.html#reducer" class="sidebar-link">reducer</a></li></ul></li><li><a href="/blog/react/redux_core.html#react中简单使用" class="sidebar-link">React中简单使用</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="redux核心点理解"><a href="#redux核心点理解" class="header-anchor">#</a> Redux核心点理解</h1> <p>其实Redux本身并不复杂。我们只要理解了<code>state</code>、<code>action</code>、<code>reducer</code>这几个核心概念，就可以学会Redux。</p> <p>不要把觉得Redux有什么特别的魔法，其实也就是一些对象和函数而已。</p> <h2 id="概念理解"><a href="#概念理解" class="header-anchor">#</a> 概念理解</h2> <h3 id="state"><a href="#state" class="header-anchor">#</a> state</h3> <p><code>state</code>，就是React等界面库托付给Redux管理的数据，和React本身的state是一样一样的。比如：</p> <h3 id="action"><a href="#action" class="header-anchor">#</a> action</h3> <p><code>action</code>，一个普通的JavaScript对象(真的就是一个普通的JavaScript对象，没有什么了不起的技术)或者是返回对象的函数。它的主要作用就是描述我们要做什么而已。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span>type<span class="token operator">:</span><span class="token string">&quot;count_ADD&quot;</span><span class="token punctuation">,</span>num<span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">}</span>
<span class="token comment">// type 是action必需的一个字段，描述这个action是干嘛的，其他的是一些参数而已。</span>
<span class="token comment">// action对象会被传递给reducer。</span>
</code></pre></div><h3 id="reducer"><a href="#reducer" class="header-anchor">#</a> reducer</h3> <p>action描述了我们要做什么，那reducer就是我们到底怎么做。</p> <p>注意了，这个没什么了不起的地方，reducer就是一些函数，只是这些函数接受<code>state</code>和<code>action</code>作为参数,并返回<span style="color:red;"><strong>新</strong></span>的<code>state</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">counter</span><span class="token punctuation">(</span><span class="token parameter">state<span class="token operator">=</span>defaultState<span class="token punctuation">,</span>action<span class="token operator">=</span><span class="token punctuation">{</span>num<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">case</span> <span class="token string">'INCREMENT'</span><span class="token operator">:</span>
            <span class="token keyword">let</span> addState <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            addState<span class="token punctuation">.</span>resultNum <span class="token operator">+=</span> action<span class="token punctuation">.</span>num<span class="token punctuation">;</span>
            <span class="token keyword">return</span> addState<span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token string">'DECREMENT'</span><span class="token operator">:</span>
            <span class="token keyword">let</span> subState <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            subState<span class="token punctuation">.</span>resultNum <span class="token operator">-=</span> action<span class="token punctuation">.</span>num<span class="token punctuation">;</span>
            <span class="token keyword">return</span> subState<span class="token punctuation">;</span>
        <span class="token keyword">default</span><span class="token operator">:</span>
            <span class="token keyword">return</span> state<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 以上就是一个reducer啦。</span>
<span class="token comment">// 接受state和action作为参数，返回新的state。 </span>
<span class="token comment">// JSON.parse(JSON.stringify(state)),深拷贝state，用于返回新的state。</span>
</code></pre></div><p>理解了这三个核心概念，我们就可以在React中用一用它了。当然，这会稍微有些繁杂，但是也不难啦。别担心，在学习了React-Redux之后，就会简化很多的。</p> <h2 id="react中简单使用"><a href="#react中简单使用" class="header-anchor">#</a> React中简单使用</h2> <div class="language-javascript extra-class"><pre class="language-javascript"><code>npm install <span class="token operator">--</span>save redux
</code></pre></div><p>React项目src目录下新建<code>store</code>目录：</p> <p><code>+ index.js</code>:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>createStore<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;redux&quot;</span><span class="token punctuation">;</span>

<span class="token comment">/*
* 第一步：redux管理的状态
* */</span>
<span class="token keyword">let</span> defaultState <span class="token operator">=</span> <span class="token punctuation">{</span>
    resultNum<span class="token operator">:</span><span class="token number">0</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">/*
* 第二步： action:
*   视图层派发action，action执行指定的reducer去修改state
* */</span>
<span class="token keyword">export</span> <span class="token keyword">let</span> <span class="token function-variable function">countADD</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">num</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    type<span class="token operator">:</span><span class="token string">'INCREMENT'</span><span class="token punctuation">,</span>
    num
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">let</span> <span class="token function-variable function">countSUB</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">num</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
   type<span class="token operator">:</span><span class="token string">'DECREMENT'</span><span class="token punctuation">,</span>
   num
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/*
* 第三步： reducer：
*   实际修改state的纯函数
*   形式：
*       (state,action)=&gt;newState
*   	需要返回全新的state，而不是修改参入的参数。
* */</span>
<span class="token keyword">function</span> <span class="token function">counter</span><span class="token punctuation">(</span><span class="token parameter">state<span class="token operator">=</span>defaultState<span class="token punctuation">,</span>action<span class="token operator">=</span><span class="token punctuation">{</span>num<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">case</span> <span class="token string">'INCREMENT'</span><span class="token operator">:</span>
            <span class="token keyword">let</span> addState <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            addState<span class="token punctuation">.</span>resultNum <span class="token operator">+=</span> action<span class="token punctuation">.</span>num<span class="token punctuation">;</span>
            <span class="token keyword">return</span> addState<span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token string">'DECREMENT'</span><span class="token operator">:</span>
            <span class="token keyword">let</span> subState <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            subState<span class="token punctuation">.</span>resultNum <span class="token operator">-=</span> action<span class="token punctuation">.</span>num<span class="token punctuation">;</span>
            <span class="token keyword">return</span> subState<span class="token punctuation">;</span>
        <span class="token keyword">default</span><span class="token operator">:</span>
            <span class="token keyword">return</span> state<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>



<span class="token comment">/*
* 第四步： 根据 reduers 创建 store ,管理 state
* */</span>

<span class="token keyword">let</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span>counter<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> store<span class="token punctuation">;</span>
</code></pre></div><p>React项目src目录下新建<code>components</code>目录:</p> <p><code>+ reduxTest.js</code>:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> store<span class="token punctuation">,</span><span class="token punctuation">{</span>countADD<span class="token punctuation">,</span>countSUB<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;../store&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">ReduxTest</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span><span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//第五步： 从store中获取state 结果等价于this.state = {resultNum:0}</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 第六步：订阅store,当store中state更新时，更新界面</span>
        store<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>resetState<span class="token punctuation">)</span>
        <span class="token comment">/* 
        	store.subscribe()接受一个函数，用于监听store中state的变化。
        	一旦state变化，就会执行监听函数，更新本组件的state。
        */</span>
    <span class="token punctuation">}</span>
    <span class="token function-variable function">resetState</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token comment">// 更新state，更新界面</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span>getState<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> <span class="token punctuation">{</span>resultNum<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>
            <span class="token operator">&lt;</span>div style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>textAlign<span class="token operator">:</span><span class="token string">&quot;center&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span><span class="token punctuation">{</span>resultNum<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>addNum<span class="token punctuation">}</span><span class="token operator">&gt;</span>添加<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>subNum<span class="token punctuation">}</span><span class="token operator">&gt;</span>减少<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token function-variable function">addNum</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token comment">// 第七步： 视图派发action</span>
        store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">countADD</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token function-variable function">subNum</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token comment">// 视图层派发action</span>
        store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">countSUB</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> ReduxTest<span class="token punctuation">;</span>
</code></pre></div><p>使用ReduxTest组件，我们便用redux完成了简单的状态管理。</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">作者：王龙楷； 标签：原创； 提交时间:</span> <span class="time">6/2/2020, 2:56:34 PM</span></div></footer> <!----> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/app.36f13d28.js" defer></script><script src="/assets/js/2.0b44b90b.js" defer></script><script src="/assets/js/80.1f4220a2.js" defer></script><script src="/assets/js/9.58f2bd3e.js" defer></script>
  </body>
</html>
